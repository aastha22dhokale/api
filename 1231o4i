Got it â€” now the requirement is crystal clear:

âœ… Requirement

When OnePAM createPostalAddress returns only:

{
  "postalAddressUsageType":"BSN_ADR",
  "countryCode":"BE"
}

â€¦and all the actual postal fields remain empty (streetName = "", cityName = "", postalCode = "" etc),

ğŸ‘‰ You want to fetch the missing postal address fields from CofaceOps table

(using OPS_UUID = DD_UUID)

â€¦and then:

1. Fill those fields into the Accounting Table entry

2. Send those fields in your final response

3. So Accounting Table always contains correct complete postal address

This is correct design, because FACT/OnePAM does not return full address after creation.

â¸»

âœ… WHERE FIELDS SHOULD COME FROM

âœ”ï¸ OnePAM returns:
	â€¢	usageType
	â€¢	effectiveDate
	â€¢	countryCode
	â€¢	endDate

âœ”ï¸ Request body may be empty (in your case)

âœ”ï¸ CofaceOps has the actual correct postal address:

From your table:

Field	CofaceOps Column
streetName	ADR_POSTALADDRESS_STREETNM
houseNumber	ADR_POSTALADDRESS_HOUSENUM
houseNumberAddition (box)	ADR_POSTALADDRESS_HOUSEADD
postalCode	ADR_POSTALADDRESS_POSTALCD
cityName	ADR_POSTALADDRESS_CITYNAME
countryCode	ADR_POSTALADDRESS_CNTRYCD


â¸»

ğŸš€ FULL FIX (END-TO-END)

STEP 1 â€” Add method in MappingDAO / CofaceOpsDAO

public CofaceOpsAddress getPostalAddressByOpsUuid(String opsUuid) {
    String sql = "SELECT ADR_POSTALADDRESS_STREETNM, ADR_POSTALADDRESS_HOUSENUM, " +
                 "ADR_POSTALADDRESS_HOUSEADD, ADR_POSTALADDRESS_POSTALCD, " +
                 "ADR_POSTALADDRESS_CITYNAME, ADR_POSTALADDRESS_CNTRYCD " +
                 "FROM COFACE_OPS_TBL WHERE OPS_UUID = ?";

    return jdbcTemplate.queryForObject(sql, (rs, rowNum) ->
        CofaceOpsAddress.builder()
            .streetName(rs.getString("ADR_POSTALADDRESS_STREETNM"))
            .houseNumber(rs.getString("ADR_POSTALADDRESS_HOUSENUM"))
            .houseAddition(rs.getString("ADR_POSTALADDRESS_HOUSEADD"))
            .postalCode(rs.getString("ADR_POSTALADDRESS_POSTALCD"))
            .cityName(rs.getString("ADR_POSTALADDRESS_CITYNAME"))
            .countryCode(rs.getString("ADR_POSTALADDRESS_CNTRYCD"))
            .build()
    , opsUuid);
}


â¸»

STEP 2 â€” In AddressService, MERGE values

CofaceOpsAddress opsAddress = mappingDAO.getPostalAddressByOpsUuid(ddUuid);

PostalAddressResponse merged = PostalAddressResponse.builder()
    .postalAddressUsageType(onePamResponse.getUsageType())
    .effectiveDate(onePamResponse.getEffectiveDate())
    .endDate(null)

    // Take from CofaceOps (Not from OnePAM)
    .streetName(opsAddress.getStreetName())
    .houseNumber(opsAddress.getHouseNumber())
    .houseNumberAddition(opsAddress.getHouseAddition())
    .postalCode(opsAddress.getPostalCode())
    .cityName(opsAddress.getCityName())
    .countryRegionCode(opsAddress.getCountryCode())

    .build();


â¸»

STEP 3 â€” Insert this merged object into Accounting Table

accountingDAO.insertPostalAddress(
    ddUuid,
    eventId,
    merged.getStreetName(),
    merged.getHouseNumber(),
    merged.getHouseNumberAddition(),
    merged.getPostalCode(),
    merged.getCityName(),
    merged.getCountryRegionCode()
);

âœ” All fields will be filled
âœ” Table now consistent
âœ” Response to client will contain full address

â¸»

STEP 4 â€” FIX SQL (Mandatory)

Replace:

EVENT_ID = eventId

with:

EVENT_ID = ?


â¸»

ğŸ”¥ RESULT AFTER FIX

OnePam:

usageType=BSN_ADR
countryCode=BE
effectiveDate=...

CofaceOps:

Street = â€œBrussels Main Stâ€
House = â€œ12â€
Box = â€œBâ€
Postal = â€œ1000â€
City = â€œBrusselsâ€
Country = â€œBEâ€

Final merged PostalAddressResponse (what you send + store):

{
  "postalAddressUsageType": "BSN_ADR",
  "countryCode": "BE",
  "streetName": "Brussels Main St",
  "houseNumber": "12",
  "houseNumberAddition": "B",
  "postalCode": "1000",
  "cityName": "Brussels"
}


â¸»

ğŸš€ If you want

I can generate:

âœ” FULL updated DAO file

âœ” FULL updated AddressService file

âœ” CofaceOps DAO class

âœ” Merged PostalAddressResponse builder

âœ” End-to-end flow diagram

âœ” Correct logs expected

Just tell me:

â€œSend full updated filesâ€ or
â€œSend AddressService + DAO onlyâ€
